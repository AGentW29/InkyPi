{% extends "plugin.html" %}

{% block content %}
<div class="diagnostics-container">
  <h2>Diagnostics</h2>
  <p>Run a full-screen color cycle to verify the display.</p>
  <div class="buttons-container">
    <button id="startTest" class="action-button">Start Color Cycle</button>
  </div>
  <div id="status" style="margin-top:10px; font-weight:600;"></div>
</div>

<script>
document.getElementById('startTest').addEventListener('click', async () => {
  const status = document.getElementById('status');
  status.textContent = 'Starting...';
  try {
    const res = await fetch('/diagnostics/color_cycle', { method: 'POST' });
    const json = await res.json();
    if (res.ok) {
      status.textContent = json.message;
    } else {
      status.textContent = json.error || 'Failed to start';
    }
  } catch (err) {
    status.textContent = 'Request failed';
  }
});
</script>
{% endblock %}
